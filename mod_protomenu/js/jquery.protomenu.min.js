/**
	Protomenu 0.11.0
	Carsten Ruppert - 2017-11-29

	0.11.0 – 2017-11-29
	- Unterscheidung Touch und Mouseover, wenn Option „Mouseover” eingeschaltet ist.
	- etc.

	0.10.0 – 2017-11-06
	- Entkernt!
	- Abhängigkeit von $.prepareTransition entfernt
	- Abhängigkeit von $.touchSwipe entfernt
*/
'use strict';
(function(d){d.Protomenu=function(a,b){this.$node=d(b);this.$node.data("protomenu",this);this._init(a)};d.Protomenu.defaults={classopen:"open",seperateswitch:!1,mouseover:!1,clickAnywhere:!1};d.Protomenu.prototype={_init:function(a){this.opt=d.extend({},d.Protomenu.defaults,a);this.$menu=this.$node.find(".nav-first");this.setupTriggers();this.setupEvents()},attachTriggerEvent:function(a){var b=this;if(this.opt.mouseover)a.on("mouseover.protomenu",function(a){var c=d(this);c.data("ptmenu")&&a.stopPropagation();
b.toggleSubmenu(c,!0)}),a.on("touchend.protomenu",function(a){var c=d(this);c.data("ptmenu")&&(a.preventDefault(),a.stopPropagation());b.toggleSubmenu(c)});else a.on("click.protomenu",function(a){var c=d(this);c.data("ptmenu")&&(a.preventDefault(),a.stopPropagation());b.toggleSubmenu(c)})},setupEvents:function(){var a=this;if(this.opt.clickAnywhere)d(document).on("click",function(b){a.closeRoot()});this.$node.find(".nav-module, .nav-child-toolbar, .nav-item, .nav-container-toolbar").on("click.protomenu",
function(a){a.stopPropagation()})},setupTriggers:function(){this.$submenus=this.$menu.find(".nav-container, .nav-child").not(".mega .nav-child .nav-child");for(var a=0,b=this.$submenus.length;a<b;a++){for(var c=this.$submenus.eq(a),d=this.$menu.find(".trigger-"+c.attr("id")),g=0,l=d.length;g<l;g++){var f=d.eq(g),h={submenu:c},e=f.children(".item-switch");f=e.length&&this.opt.seperateswitch?e:f;f.data("ptmenu",h)}h={triggers:d};c.data("ptmenu",h)}this.items=this.$menu.find(".nav-item");for(a=0;a<this.items.length;a++)b=
this.items.eq(a),e=b.children(".item-switch"),this.attachTriggerEvent(e.length&&this.opt.seperateswitch?e:b)},disableTriggers:function(a){a.data("ptmenu").triggers.removeClass("open");a=a.find(".nav-child");for(var b=0,c=a.length;b<c;b++)a.eq(b).data("ptmenu").triggers.removeClass("open")},disableDescestors:function(a){a=a.find(".nav-child");a.removeClass("open in");for(var b=0,c=a.length;b<c;b++)this.disableTriggers(a.eq(b))},hideSub:function(a){var b=0;a.css("transition-duration").split(",").forEach(function(a){a=
parseFloat(a);b=a>b?a:b});0<b?(window.setTimeout(function(a){a.removeClass("in");this.disableDescestors(a)}.bind(this,a),1E3*b),a.removeClass("open")):(a.removeClass("open in"),this.disableDescestors(a));this.disableTriggers(a)},showSub:function(a){this.closeEqual(a);a.addClass("open in");a.data("ptmenu").triggers.addClass("open")},closeRoot:function(){var a=this.$menu.find(".nav-child.nav-level-2.open");a.length&&this.hideSub(a)},closeEqual:function(a){a=a.parent().parent().find(".nav-child.open").not(a);
for(var b=0,c=a.length;b<c;b++)this.hideSub(a.eq(b))},toggleSubmenu:function(a,b){if(a.data("ptmenu")){var c=a.data("ptmenu").submenu;c.hasClass(this.opt.classopen)&&!b?(this.hideSub(c),a.blur()):this.showSub(c);if(b){var k=this;this.$menu.children("li").off("mousemove.protomenu").on("mousemove.protomenu",function(a){d(this).find("#"+c.attr("id")).length||(d(document).off("mousemove.protomenu"),k.closeRoot())});d(document).off("mousemove.protomenu").on("mousemove.protomenu",function(a){d(a.target).parents(".ptmenu").length||
(d(document).off("mousemove.protomenu"),k.closeRoot())})}}else b&&this.closeEqual(a)}};d.fn.protomenu=function(a){var b=d(this).data("protomenu");void 0===b&&(b=new d.Protomenu(a,this));return b}})(jQuery);
