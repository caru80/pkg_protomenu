/*
      Copyright Â© 2018 HEAD. MARKETING GmbH All Rights Reserved
 @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
*/
(function(c){c.Protomenu=function(a,b){this.$node=c(b);this.$node.data("protomenu",this);this._init(a)};c.Protomenu.defaults={classNames:{open:"open","in":"in"},classRtl:"rtl",classBtl:"btt",autoalign:!0,seperateswitch:!1,mouseover:!1,clickAnywhere:!1,plugins:[]};c.Protomenu.Plugins=[];c.Protomenu.prototype={_init:function(a){this.opt=c.extend({},c.Protomenu.defaults,a);this.$wrapper=this.$node.children(".nav-wrapper");this.$menu=this.$node.find(".nav-first");this.setupTriggers();this.setupEvents();
this.opt.plugins=this.opt.plugins.concat(c.Protomenu.Plugins);this.opt.plugins=this.opt.plugins.filter(function(a,b,c){return c.indexOf(a)===b});if(0<this.opt.plugins.length){a=0;for(var b=this.opt.plugins.length;a<b;a++)this[this.opt.plugins[a]]=new c[this.opt.plugins[a]](this)}},attachTriggerEvent:function(a){var b=this;if(this.opt.mouseover)a.on("mouseover.protomenu",function(a){var d=c(this);d.data("ptmenu")&&a.stopPropagation();b.toggleSubmenu(d,!0)}),a.on("touchend.protomenu",function(a){var d=
c(this);d.data("ptmenu")&&c(a.target).parents("li").get(0)===this&&(a.preventDefault(),a.stopPropagation());b.toggleSubmenu(d)});else a.on("click.protomenu",function(a){var d=c(this);d.data("ptmenu")&&(a.preventDefault(),a.stopPropagation());b.toggleSubmenu(d)})},setupEvents:function(){var a=this;if(this.opt.clickAnywhere)c(document).on("click",function(b){a.closeRootLevel()});this.$node.find(".nav-module, .nav-item").on("click.protomenu",function(a){a.stopPropagation()})},setupTriggers:function(){for(var a=
this.$menu.find("[data-ptm-child]"),b=0,d=a.length;b<d;b++){var c=a.eq(b);var f=this.opt.mouseover?this.$menu.find('[data-ptm-item="'+c.data("ptm-child")+'"]'):this.$menu.find('[data-ptm-trigger="'+c.data("ptm-child")+'"]');for(var h=0,l=f.length;h<l;h++){var g=f.eq(h),m={submenu:c},k=g.find("[data-ptm-switcher]");g=k.length&&this.opt.seperateswitch?k:g;g.data("ptmenu",m)}c.data("ptmenu",{triggers:f})}a=this.opt.mouseover?this.$menu.find("[data-ptm-item]").not("[data-ptm-item].static"):this.$menu.find("[data-ptm-trigger]");
b=0;for(d=a.length;b<d;b++)c=a.eq(b),f=c.find("[data-ptm-switcher]"),f.length&&this.opt.seperateswitch&&(c=f),this.attachTriggerEvent(c)},disableTriggers:function(a){a.data("ptmenu").triggers.removeClass(this.opt.classNames.open);a=a.find("[data-ptm-child]");for(var b=0,c=a.length;b<c;b++){var e=a.eq(b).data("ptmenu");e&&e.triggers.removeClass(this.opt.classNames.open)}},disableDescestors:function(a){a.find("[data-ptm-child]").removeClass(c.map(this.opt.classNames,function(a){return a}).join(" "))},
disableAfterTransition:function(a){a.removeClass(this.opt.classNames["in"]);this.disableDescestors(a);if(this.opt.mouseover)for(var b=0,c=a.data("ptmenu").triggers.length;b<c;b++)a.data("ptmenu").triggers.eq(b)},pauseEvent:function(a,b){a.data("paused-events")||a.data("paused-events",{});a.data("paused-events")[b]=a.data("events")[b];a.data("events")[b]=null},unpauseEvent:function(a,b){a.data("paused-events")&&(a.data("events")[b]=a.data("paused-events")[b],a.data("paused-events")[b]=null)},hideSub:function(a){var b=
a.css("transition-duration").split(","),d=a.data("ptmenu"),e=0;b.forEach(function(a){a=parseFloat(a);e=a>e?a:e});if(0<e){d.timeout=window.setTimeout(this.disableAfterTransition.bind(this,a),1E3*e);if(this.opt.mouseover){b=0;for(var f=d.triggers.length;b<f;b++)d.triggers.eq(b)}a.data("ptmenu",d);a.removeClass(this.opt.classNames.open)}else a.removeClass(c.map(this.opt.classNames,function(a){return a}).join(" ")),this.disableDescestors(a);this.disableTriggers(a);this.$node.triggerHandler("afterStateChanged",
{closed:a})},getVps:function(){var a=window,b=document.documentElement,c=document.getElementsByTagName("body")[0];return{w:a.innerWidth||b.clientWidth||c.clientWidth,h:a.innerHeight||b.clientHeight||c.clientHeight}},isInViewport:function(a,b){var c=this.getVps(),e=a.scrollTop();return c.h+e>=b.offset().top&&b.offset().top+b.height()>e?!0:!1},setSubmenuScrollPosition:function(a){var b=c("[data-ptm-item].active",a),d=c(".nav-child-header",a);d=d.length?d.outerHeight():0;b.length&&!this.isInViewport(a,
b.eq(b.length-1))?this.$wrapper.scrollTop(Math.ceil(b.eq(b.length-1).position().top)-d):this.$wrapper.scrollTop(0)},showSub:function(a){var b=a.data("ptmenu");b.timeout&&this.opt.mouseover&&window.clearTimeout(b.timeout);this.closeEqualLevel(a);a.addClass(this.opt.classNames["in"]);this.setSubmenuScrollPosition(a);0>this.getVps().w-(a.offset().left+a.outerWidth())&&a.addClass(this.opt.classRtl);this.getVps();a.offset();a.outerHeight();a.addClass(this.opt.classNames.open);b.triggers.addClass(this.opt.classNames.open);
this.$node.triggerHandler("afterStateChanged",{opened:a})},closeRootLevel:function(){var a=this.$menu.find("."+this.opt.classNames.open+'[data-ptm-child][data-ptm-level="2"]');a.length&&this.hideSub(a)},closeEqualLevel:function(a){a=a.parent().parent().find("."+this.opt.classNames.open+"[data-ptm-child]").not(a);for(var b=0,c=a.length;b<c;b++)this.hideSub(a.eq(b))},isExpanded:function(a){return(a?this.$menu.find("."+this.opt.classNames.open+'[data-ptm-child][data-ptm-level="2"]'):this.$menu.find("."+
this.opt.classNames.open+"[data-ptm-child]")).length?!0:!1},toggleSubmenu:function(a,b){if(a.data("ptmenu")){var d=a.data("ptmenu").submenu,e=d.hasClass(this.opt.classNames.open);e&&!b?(this.hideSub(d),a.blur()):e||this.showSub(d);b&&!e&&(a.parents("[data-ptm-sub]").one("mouseout.protomenu",function(a,b,d){d.currentTarget===d.relatedTarget&&this.closeEqualLevel(c(d.currentTarget))}.bind(this,a,d)),c(document).off("mousemove.protomenu").on("mousemove.protomenu",function(a){c(a.target).closest("[data-ptm-root]").length||
(c(document).off("mousemove.protomenu"),this.closeRootLevel())}.bind(this)))}else b&&this.closeEqualLevel(a)}};c.fn.protomenu=function(a){var b=c(this).data("protomenu");void 0===b&&(b=new c.Protomenu(a,this));return b}})(jQuery);
(function(c){c.Protomenu.defaults.backDrop={template:'<div class="ptmenu-backdrop"></div>'};c.ProtomenuBackdrop=function(a){this.parent=a;this._init()};c.ProtomenuBackdrop.prototype={_init:function(){this.backdrop=c(this.parent.opt.backDrop.template);this.timer=null;c("body").prepend(this.backdrop);this.parent.$node.on("afterStateChanged",function(a){this.parent.isExpanded(!0)?this.backdrop.addClass(c.map(this.parent.opt.classNames,function(a){return a}).join(" ")):this.close()}.bind(this))},close:function(){window.clearTimeout(this.timer);
var a=0;this.backdrop.css("transition-duration").split(",").forEach(function(b){b=parseFloat(b);a=b>a?b:a});this.timer=window.setTimeout(function(){this.parent.isExpanded()||this.backdrop.removeClass(this.parent.opt.classNames["in"])}.bind(this),1E3*a);this.backdrop.removeClass(this.parent.opt.classNames.open)}};c.Protomenu.defaults.html5video={autoplay:!0};c.ProtomenuHtml5Video=function(a){this.parent=a;this._init()};c.ProtomenuHtml5Video.prototype={_init:function(){this.parent.$node.on("afterStateChanged",
function(a,b){this.tick(b)}.bind(this))},tick:function(a){a.closed&&a.closed.find("video").each(function(){this.pause();this.currentTime&&(this.currentTime=0)});if(a.opened){a=a.opened.find("video");for(var b,d=0,e=a.length;d<e;d++)if(b=a.get(d),b.offsetWidth,2<=b.readyState)this.playVideo(b);else c(b).one("canplay.protomenu.html5video",function(a){this.playVideo(a.originalTarget)}.bind(this))}},playVideo:function(a){if(a){var b=c(a).data("ptoptions")||{};(this.parent.opt.html5video.autoplay||b.autoplay)&&
a.play()}}}})(jQuery);