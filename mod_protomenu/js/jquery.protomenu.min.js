
/**
 * @package        HEAD. Protomenü 2
 * @version        4.0
 * 
 * @author         Carsten Ruppert <webmaster@headmarketing.de>
 * @link           https://www.headmarketing.de
 * @copyright      Copyright © 2018 - 2019 HEAD. MARKETING GmbH All Rights Reserved
 * @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */
(function(c){c.Protomenu=function(a,b){this.$node=c(b);this.$node.data("protomenu",this);this._init(a)};c.Protomenu.defaults={"class":{open:"open",expanded:"expanded",rtl:"rtl",btt:"btt"},autoalign:!0,seperateswitch:!1,mouseover:!1,clickAnywhere:!1,plugins:[],events:{mouse:"mouseenter.protomenu",mouseDelay:200,touch:"touchend.protomenu",click:"click.protomenu"}};c.Protomenu.Plugins=[];c.Protomenu.prototype={_init:function(a){this.opt=c.extend(!0,{},c.Protomenu.defaults,a);this.$wrapper=this.$node.children(".nav-wrapper");
this.childMenus=this.$node.find(".ptmenu");this.childSubmenus=this.childMenus.find("[data-ptm-child]");this.setup();this.initPlugins()},setup:function(){for(var a=this.$node.find("[data-ptm-child]").not(this.childSubmenus),b=0,d=a.length;b<d;b++){for(var e=a.eq(b),f=this.$node.find('[data-ptm-item="'+e.data("ptm-child")+'"]').not("[data-ptm-item].static"),h=0,l=f.length;h<l;h++){var g=f.eq(h),m={submenu:e},k=g.find("[data-ptm-switcher]");g=k.length&&this.opt.seperateswitch?k:g;g.data("ptmenu",m);
this.attachTriggerEvent(g)}e.data("ptmenu",{triggers:f})}if(this.opt.clickAnywhere)c(document).on("click.protomenu",function(a){!1===c.contains(this.$node.get(0),a.target)&&this.closeRootLevel()}.bind(this));this.$node.on("afterStateChanged.protomenu",function(){this.isExpanded()?this.$node.addClass(this.opt["class"].expanded):this.$node.removeClass(this.opt["class"].expanded)}.bind(this))},initPlugins:function(){this.opt.plugins=this.opt.plugins.concat(c.Protomenu.Plugins);this.opt.plugins=this.opt.plugins.filter(function(a,
b,c){return c.indexOf(a)===b});if(0<this.opt.plugins.length)for(var a=0,b=this.opt.plugins.length;a<b;a++)this[this.opt.plugins[a]]=new c[this.opt.plugins[a]](this)},attachTriggerEvent:function(a){var b=this;if(this.opt.mouseover)a.on(this.opt.events.mouse,function(a){var d=c(this),f=["mouseenter","mouseover"];0<b.opt.events.mouseDelay&&~f.indexOf(a.type)?(d.one("mouseleave.ildetimer",function(){window.clearTimeout(this._ptmenuIdleTimer)}),d.get(0)._ptmenuIdleTimer=window.setTimeout(function(a,b){this.toggleSubmenu(b,
a);a.off(".ildetimer")}.bind(b,d,a),b.opt.events.mouseDelay)):b.toggleSubmenu(a,d)}),a.on(this.opt.events.touch,function(a){var d=c(this);c(a.target).parents("[data-ptm-item]").get(0)===this&&(a.preventDefault(),a.stopPropagation(),b.toggleSubmenu(a,d))});else a.on(this.opt.events.click,function(a){var d=c(this);c(a.target).parents("[data-ptm-item]").get(0)===this&&(a.preventDefault(),a.stopPropagation());b.toggleSubmenu(a,d)})},getVps:function(){var a=window,b=document.documentElement,c=document.getElementsByTagName("body")[0];
return{w:a.innerWidth||b.clientWidth||c.clientWidth,h:a.innerHeight||b.clientHeight||c.clientHeight}},disableTriggers:function(a){a.data("ptmenu").triggers.removeClass(this.opt["class"].open)},closeDescestors:function(a){a=a.find("[data-ptm-item]."+this.opt["class"].open).not(this.childMenus.find("[data-ptm-item]")).not(".nav-child-header [data-ptm-item]");for(var b=0,c=a.length;b<c;b++){var e=this.$node.find('[data-ptm-child="'+a.eq(b).data("ptm-item")+'"].'+this.opt["class"].open);e.length&&(e.removeClass(this.opt["class"].open),
this.disableTriggers(e))}},closeRootLevel:function(){var a=this.$node.find('[data-ptm-child][data-ptm-level="2"].'+this.opt["class"].open).not(this.childSubmenus);a.length&&this.hideSub(a)},closeEqualLevel:function(a){a=this.$node.find('[data-ptm-level="'+a.data("ptm-level")+'"]').not(a).not(this.childSubmenus);for(var b=0,c=a.length;b<c;b++)this.hideSub(a.eq(b))},toggleSubmenu:function(a,b){if(c(b).data("ptmenu")){var d=b.data("ptmenu"),e=d.submenu.hasClass(this.opt["class"].open);switch(a.type){case "mouseenter":case "mouseover":this.showSub(d.submenu);
break;case "mouseleave":case "mouseout":this.hideSub(d.submenu);break;default:e?this.hideSub(d.submenu):this.showSub(d.submenu)}}},hideSub:function(a){var b=a.parents("[data-ptm-child]");a.removeClass(this.opt["class"].open);this.closeDescestors(a);this.disableTriggers(a);b.length&&b.eq(b.length-1).removeClass(this.opt["class"].expanded);this.$node.triggerHandler("afterStateChanged",{closed:a})},showSub:function(a){var b=a.data("ptmenu"),c=a.parents("[data-ptm-child]");this.closeEqualLevel(a);a.addClass(this.opt["class"].open);
b.triggers.addClass(this.opt["class"].open);this.opt.autoalign&&0>this.getVps().w-(a.offset().left+a.outerWidth())&&a.addClass(this.opt["class"].rtl);c.length&&c.eq(c.length-1).addClass(this.opt["class"].expanded);this.$node.triggerHandler("afterStateChanged",{opened:a})},isExpanded:function(a){a=a?this.$node.find("."+this.opt["class"].open+'[data-ptm-child][data-ptm-level="2"]').not(this.childSubmenus):this.$node.find("."+this.opt["class"].open+"[data-ptm-child]").not(this.childSubmenus);return a.length?
a.length:!1}};c.fn.protomenu=function(a){var b=c(this).data("protomenu");void 0===b&&(b=new c.Protomenu(a,this));return b}})(jQuery);
(function(c){c.Protomenu.defaults.backDrop={template:'<div class="ptmenu-backdrop"></div>'};c.ProtomenuBackdrop=function(a){this.parent=a;this._init()};c.ProtomenuBackdrop.prototype={_init:function(){this.backdrop=c(this.parent.opt.backDrop.template);this.timer=null;c("body").prepend(this.backdrop);this.parent.$node.on("afterStateChanged",function(a){this.parent.isExpanded(!0)?this.backdrop.addClass(this.parent.opt["class"].open):this.close()}.bind(this))},close:function(){window.clearTimeout(this.timer);
var a=0;this.backdrop.css("transition-duration").split(",").forEach(function(b){b=parseFloat(b);a=b>a?b:a});this.timer=window.setTimeout(function(){this.parent.isExpanded()}.bind(this),1E3*a);this.backdrop.removeClass(this.parent.opt["class"].open)}};c.Protomenu.defaults.html5video={autoplay:!0};c.ProtomenuHtml5Video=function(a){this.parent=a;this._init()};c.ProtomenuHtml5Video.prototype={_init:function(){this.parent.$node.on("afterStateChanged",function(a,b){this.tick(b)}.bind(this))},tick:function(a){a.closed&&
a.closed.find("video").each(function(){this.pause();this.currentTime&&(this.currentTime=0)});if(a.opened){a=a.opened.find("video");for(var b,d=0,e=a.length;d<e;d++)if(b=a.get(d),b.offsetWidth,2<=b.readyState)this.playVideo(b);else c(b).one("canplay.protomenu.html5video",function(a){this.playVideo(a.originalTarget)}.bind(this))}},playVideo:function(a){if(a){var b=c(a).data("ptoptions")||{};(this.parent.opt.html5video.autoplay||b.autoplay)&&a.play()}}}})(jQuery);